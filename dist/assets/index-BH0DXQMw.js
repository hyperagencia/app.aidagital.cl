import{j as e,U as a,l as s,c as t,a as r,f as l}from"./index-CAD7YyIr.js";import{a as i}from"./vendor-BAsl6vX1.js";import{a as o,c as n}from"./creatorsService-h6MksilP.js";const c=({searchTerm:s,onSearchChange:t,placeholder:r="Buscar por nombre o email..."})=>e.jsx(a.Card,{className:"mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(a.Input,{type:"text",placeholder:r,value:s,onChange:e=>t(e.target.value),className:"pl-12 text-lg py-4"}),e.jsx("div",{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 text-xl"})]})});const d=new class{constructor(){this.baseEndpoint="/favorites.php"}async getFavorites(){try{s("Fetching user favorites");const e=await o.get(this.baseEndpoint);if(e.success)return s(`Fetched ${e.data.favorites.length} favorites`),{success:!0,favorites:e.data.favorites,total:e.data.total||e.data.favorites.length};throw new Error(e.message||t.ERRORS.UNKNOWN)}catch(e){throw r(e,"Get favorites"),new Error(e.message||t.ERRORS.NETWORK)}}async toggleFavorite(e){try{s(`Toggling favorite for creator ${e}`);const a=await o.post(this.baseEndpoint,{creator_id:e});if(a.success){const t=a.data.action,r=a.data.is_favorite;return s(`Creator ${e} ${t} ${r?"to":"from"} favorites`),{success:!0,creatorId:e,isFavorite:r,action:t,message:a.message}}throw new Error(a.message||t.ERRORS.UNKNOWN)}catch(a){throw r(a,`Toggle favorite for creator ${e}`),new Error(a.message||t.ERRORS.NETWORK)}}async removeFavorite(e){try{s(`Removing favorite for creator ${e}`);const a=await o.delete(`${this.baseEndpoint}?creator_id=${e}`);if(a.success)return s(`Creator ${e} removed from favorites`),{success:!0,creatorId:e,isFavorite:!1,message:a.message};throw new Error(a.message||t.ERRORS.UNKNOWN)}catch(a){throw r(a,`Remove favorite for creator ${e}`),new Error(a.message||t.ERRORS.NETWORK)}}async addFavorite(e){return await this.toggleFavorite(e)}async isFavorite(e){try{const a=await this.getFavorites();return!!a.success&&a.favorites.some(a=>a.id===e)}catch(a){return r(a,`Check if creator ${e} is favorite`),!1}}},m=({filters:t})=>{const{selectedInterests:r,selectedPlatforms:o,ageRange:c,selectedNationality:d,selectedLocation:m,selectedModality:h,handleInterestToggle:x,handlePlatformToggle:g,setAgeRange:u,setSelectedNationality:f,setSelectedLocation:v,setSelectedModality:p,clearFilters:j,filterOptions:y,totalCreators:N,filteredCount:w,hasActiveFilters:b}=t,{exporting:C,exportCreators:S}=(()=>{const[e,a]=i.useState(!1),[t,r]=i.useState(null);return{exporting:e,exportError:t,exportCreators:i.useCallback(async(e={},t="csv")=>{try{a(!0),r(null);const l=await n.exportCreators(e,t);if(l.success){if(l.downloadUrl)window.open(l.downloadUrl,"_blank");else if(l.data){const e=new Blob([l.data],{type:"csv"===t?"text/csv":"application/json"}),a=URL.createObjectURL(e),s=document.createElement("a");s.href=a,s.download=l.filename||`creators.${t}`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a)}return s("Export completed successfully"),{success:!0}}}catch(l){return r(l.message),{success:!1,message:l.message}}finally{a(!1)}},[])}})();return e.jsxs(a.Card,{className:"mb-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Intereses"}),e.jsxs(a.Select,{value:"",onChange:e=>{e.target.value&&x(e.target.value)},children:[e.jsx("option",{value:"",children:r.length>0?`${r.length} seleccionados`:"Seleccionar intereses..."}),y.interests.map(a=>e.jsx("option",{value:a,disabled:r.includes(a),children:l.formatInterests([a])},a))]}),r.length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:r.map(s=>e.jsxs(a.Badge,{variant:"purple",size:"sm",className:"cursor-pointer",onClick:()=>x(s),children:[l.formatInterests([s]).substring(0,15),e.jsx("span",{className:"ml-1",children:"Ã—"})]},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plataformas"}),e.jsxs(a.Select,{value:"",onChange:e=>{e.target.value&&g(e.target.value)},children:[e.jsx("option",{value:"",children:o.length>0?`${o.length} seleccionadas`:"Seleccionar plataformas..."}),y.platforms.map(a=>e.jsx("option",{value:a,disabled:o.includes(a),children:l.formatPlatform(a)},a))]}),o.length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:o.map(s=>e.jsxs(a.Badge,{variant:"blue",size:"sm",className:"cursor-pointer",onClick:()=>g(s),children:[l.formatPlatform(s),e.jsx("span",{className:"ml-1",children:"Ã—"})]},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rango de edad"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(a.Input,{type:"number",placeholder:"Min",value:c.min,onChange:e=>u(a=>({...a,min:e.target.value})),min:"18",max:"80"}),e.jsx(a.Input,{type:"number",placeholder:"Max",value:c.max,onChange:e=>u(a=>({...a,max:e.target.value})),min:"18",max:"80"})]})]}),e.jsxs(a.Select,{label:"Nacionalidad",value:d,onChange:e=>f(e.target.value),children:[e.jsx("option",{value:"",children:"Todas las nacionalidades"}),y.nationalities.map(a=>e.jsx("option",{value:a,children:l.formatNationality(a)},a))]}),e.jsxs(a.Select,{label:"UbicaciÃ³n",value:m,onChange:e=>v(e.target.value),children:[e.jsx("option",{value:"",children:"Todas las ubicaciones"}),y.locations.map(a=>e.jsx("option",{value:a,children:l.formatLocation(a)},a))]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Mostrando ",w," de ",N," creators"]}),b&&e.jsx(a.Badge,{variant:"purple",children:"Filtrado"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[b&&e.jsx(a.Button,{variant:"secondary",size:"sm",onClick:j,children:"Limpiar filtros"}),e.jsx(a.Button,{variant:"primary",size:"sm",onClick:async()=>{const e={interests:r,platforms:o,ageMin:c.min,ageMax:c.max,nationality:d,location:m,modality:h};await S(e,"csv")},loading:C,children:"Exportar"})]})]})]})},h=({creator:t,onEdit:o,onDelete:n,onAssignBrand:c,onFavoriteChange:m})=>{const[h,x]=i.useState(!1),[g,u]=i.useState(t.is_favorite||!1),{toggleFavorite:f,loading:v}=(()=>{const[e,a]=i.useState(!1),[t,l]=i.useState(null);return{loading:e,error:t,toggleFavorite:i.useCallback(async(e,t=!1)=>{try{a(!0),l(null);const t=await d.toggleFavorite(e);if(t.success)return s(`Favorite toggled: Creator ${e} is now ${t.isFavorite?"favorited":"unfavorited"}`),{success:!0,creatorId:t.creatorId,isFavorite:t.isFavorite,action:t.action,message:t.message};throw new Error("Failed to toggle favorite")}catch(i){const a=i.message||"Error al cambiar favorito";return l(a),r(i,`Toggle favorite for creator ${e}`),{success:!1,error:a}}finally{a(!1)}},[]),addToFavorites:i.useCallback(async e=>{try{a(!0),l(null);const t=await d.addFavorite(e);if(t.success)return s(`Creator ${e} added to favorites`),{success:!0,creatorId:t.creatorId,isFavorite:!0,message:t.message};throw new Error("Failed to add to favorites")}catch(t){const a=t.message||"Error al agregar a favoritos";return l(a),r(t,`Add to favorites creator ${e}`),{success:!1,error:a}}finally{a(!1)}},[]),removeFromFavorites:i.useCallback(async e=>{try{a(!0),l(null);const t=await d.removeFavorite(e);if(t.success)return s(`Creator ${e} removed from favorites`),{success:!0,creatorId:t.creatorId,isFavorite:!1,message:t.message};throw new Error("Failed to remove from favorites")}catch(t){const a=t.message||"Error al quitar de favoritos";return l(a),r(t,`Remove from favorites creator ${e}`),{success:!1,error:a}}finally{a(!1)}},[]),clearError:i.useCallback(()=>{l(null)},[])}})();return e.jsxs(a.Card,{hover:!0,className:"transition-all duration-200",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start space-x-3 mb-3",children:[e.jsx(a.Avatar,{name:t.full_name,size:"lg"}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:t.full_name}),e.jsxs("p",{className:"text-gray-600 text-sm",children:[t.age," aÃ±os, ",l.formatNationality(t.nationality)]})]}),e.jsx("button",{onClick:async()=>{const e=await f(t.id,g);e.success&&(u(e.isFavorite),null==m||m(t.id,e.isFavorite))},disabled:v,className:`ml-2 p-2 rounded-full transition-colors ${g?"text-red-500 hover:text-red-600 bg-red-50":"text-gray-400 hover:text-red-500 hover:bg-red-50"} ${v?"opacity-50 cursor-not-allowed":""}`,title:g?"Quitar de favoritos":"Agregar a favoritos",children:v?e.jsx(a.Spinner,{size:"sm"}):e.jsx("span",{className:"text-xl",children:g?"â¤ï¸":"ðŸ¤"})})]})})]}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsx("p",{className:"font-medium text-gray-700",children:"Contacto"}),e.jsx("p",{className:"text-gray-600",children:t.email}),e.jsx("p",{className:"text-gray-600",children:l.formatPhone(t.phone)})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Intereses"}),e.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:l.formatInterests(t.interests)})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Plataformas"}),t.social_networks&&t.social_networks.length>0?e.jsx("div",{className:"space-y-2",children:t.social_networks.map((a,s)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:l.formatPlatform(a.platform)}),a.profile_link?e.jsx("a",{href:a.profile_link,target:"_blank",rel:"noopener noreferrer",className:"text-purple-600 hover:text-purple-700 text-sm font-medium",children:"Ver"}):e.jsx("span",{className:"text-gray-400 text-sm",children:"Sin enlace"})]},`${a.platform}-${s}`))}):e.jsx("p",{className:"text-gray-500 text-sm",children:"Sin plataformas registradas"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Acciones"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a.Button,{variant:"secondary",size:"sm",className:"w-full",onClick:()=>null==o?void 0:o(t),children:"Editar"}),e.jsx(a.Button,{variant:"ghost",size:"sm",className:"w-full",onClick:()=>null==c?void 0:c(t),children:"Asignar Marca"}),e.jsx("button",{className:"text-gray-400 hover:text-gray-600 text-sm w-full text-right",onClick:()=>x(!h),children:h?"â–² Menos":"â–¼ MÃ¡s"})]})]})]}),h&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-100 grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 text-sm",children:"UbicaciÃ³n"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:l.formatLocation(t.location)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 text-sm",children:"Modalidad"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:l.formatModality(t.modality)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 text-sm",children:"Registrado"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:l.formatTimeAgo(t.created_at)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 text-sm",children:"Estado"}),e.jsx(a.Badge,{variant:"green",size:"sm",className:"mt-1",children:"Activo"})]})]})]})},x=({hasFilters:s,onClearFilters:t})=>e.jsxs(a.Card,{className:"p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:s?"ðŸ”":"ðŸ‘¥"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:s?"No se encontraron creators":"No hay creators registrados"}),e.jsx("p",{className:"text-gray-600 mb-6",children:s?"Intenta ajustar los filtros o la bÃºsqueda":"Los creators que se registren aparecerÃ¡n aquÃ­"}),s&&e.jsx(a.Button,{variant:"primary",onClick:t,children:"Limpiar todos los filtros"})]}),g=({creators:s,loading:t,loadingMore:r,error:l,hasMore:i,onRefresh:o,onLoadMore:n,onFavoriteChange:c})=>t?e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((s,t)=>e.jsx(a.Card,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(a.Skeleton,{width:"w-12",height:"h-12",className:"rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(a.Skeleton,{width:"w-32",height:"h-5",className:"mb-2"}),e.jsx(a.Skeleton,{width:"w-24",height:"h-4"})]})]}),e.jsxs("div",{children:[e.jsx(a.Skeleton,{width:"w-20",height:"h-4",className:"mb-2"}),e.jsx(a.Skeleton,{width:"w-full",height:"h-4"})]}),e.jsxs("div",{children:[e.jsx(a.Skeleton,{width:"w-24",height:"h-4",className:"mb-2"}),e.jsx(a.Skeleton,{width:"w-full",height:"h-4"})]}),e.jsxs("div",{children:[e.jsx(a.Skeleton,{width:"w-20",height:"h-4",className:"mb-2"}),e.jsx(a.Skeleton,{width:"w-full",height:"h-8"})]})]})},t))}):l?e.jsxs(a.Card,{className:"p-8 text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"âš ï¸"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Error al cargar creators"}),e.jsx("p",{className:"text-gray-600 mb-4",children:l}),e.jsx(a.Button,{variant:"primary",onClick:o,children:"Reintentar"})]}):e.jsxs("div",{className:"space-y-4",children:[s.map(a=>e.jsx(h,{creator:a,onEdit:e=>{},onDelete:e=>{},onAssignBrand:e=>{},onFavoriteChange:c},a.id)),r&&e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((s,t)=>e.jsx(a.Card,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(a.Skeleton,{width:"w-12",height:"h-12",className:"rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(a.Skeleton,{width:"w-32",height:"h-5",className:"mb-2"}),e.jsx(a.Skeleton,{width:"w-24",height:"h-4"})]})]}),e.jsxs("div",{children:[e.jsx(a.Skeleton,{width:"w-20",height:"h-4",className:"mb-2"}),e.jsx(a.Skeleton,{width:"w-full",height:"h-4"})]}),e.jsxs("div",{children:[e.jsx(a.Skeleton,{width:"w-24",height:"h-4",className:"mb-2"}),e.jsx(a.Skeleton,{width:"w-full",height:"h-4"})]}),e.jsxs("div",{children:[e.jsx(a.Skeleton,{width:"w-20",height:"h-4",className:"mb-2"}),e.jsx(a.Skeleton,{width:"w-full",height:"h-8"})]})]})},`loading-${t}`))}),i&&!r&&e.jsx("div",{className:"flex justify-center pt-6",children:e.jsx(a.Button,{variant:"secondary",size:"lg",onClick:n,className:"px-8 py-3",children:"Cargar mÃ¡s creators"})}),!i&&s.length>0&&e.jsx("div",{className:"text-center py-6",children:e.jsxs("p",{className:"text-gray-500 text-sm",children:["Has visto todos los creators disponibles (",s.length," total)"]})})]}),u=()=>{const{creators:a,loading:t,loadingMore:r,error:l,hasMore:o,refresh:d,loadMore:h}=((e={})=>{const[a,t]=i.useState([]),[r,l]=i.useState(!0),[o,c]=i.useState(!1),[d,m]=i.useState(null),[h,x]=i.useState(null),[g,u]=i.useState(e),[f,v]=i.useState(!0),[p,j]=i.useState(1),y=i.useCallback(async(e=g,a=!0)=>{try{a&&(l(!0),j(1)),m(null);const r={...e,page:a?1:p,limit:20},i=await n.getCreators(r);i.success&&(t(a?i.creators:e=>[...e,...i.creators]),x(i.pagination),i.pagination?v(i.pagination.page<i.pagination.pages):v(!1),s(`Loaded ${i.creators.length} creators (page ${r.page})`))}catch(r){m(r.message),s("Error loading creators:",r.message)}finally{l(!1),c(!1)}},[g,p]),N=i.useCallback(async()=>{if(f&&!o)try{c(!0),m(null);const e=p+1;j(e);const a={...g,page:e,limit:20},r=await n.getCreators(a);r.success&&(t(e=>[...e,...r.creators]),x(r.pagination),r.pagination?v(e<r.pagination.pages):v(!1),s(`Loaded ${r.creators.length} more creators (page ${e})`))}catch(e){m(e.message),s("Error loading more creators:",e.message)}finally{c(!1)}},[g,p,f,o]);i.useEffect(()=>{y(g,!0)},[JSON.stringify(g)]);const w=i.useCallback(e=>{u(a=>({...a,...e})),j(1),v(!0)},[]),b=i.useCallback(()=>{u({}),j(1),v(!0)},[]),C=i.useCallback(()=>{y(g,!0)},[y,g]);return{creators:a,loading:r,loadingMore:o,error:d,pagination:h,filters:g,hasMore:f,currentPage:p,updateFilters:w,clearFilters:b,refresh:C,fetchCreators:y,loadMore:N}})(),u=((e=[])=>{const[a,s]=i.useState(""),[t,r]=i.useState([]),[l,o]=i.useState([]),[c,d]=i.useState({min:"",max:""}),[m,h]=i.useState(""),[x,g]=i.useState(""),[u,f]=i.useState(""),v=i.useMemo(()=>{const a=new Set,s=new Set,t=new Set,r=new Set,l=new Set;return e.forEach(e=>{e.interests&&e.interests.forEach(e=>a.add(e)),e.platforms&&e.platforms.forEach(e=>s.add(e)),e.nationality&&t.add(e.nationality),e.location&&r.add(e.location),e.modality&&l.add(e.modality)}),{interests:Array.from(a).sort(),platforms:Array.from(s).sort(),nationalities:Array.from(t).sort(),locations:Array.from(r).sort(),modalities:Array.from(l).sort()}},[e]),p=i.useMemo(()=>{const s={searchTerm:a,interests:t,platforms:l,ageMin:c.min,ageMax:c.max,nationality:m,location:x,modality:u};return n.filterCreators(e,s)},[e,a,t,l,c,m,x,u]),j=i.useCallback(e=>{r(a=>a.includes(e)?a.filter(a=>a!==e):[...a,e])},[]),y=i.useCallback(e=>{o(a=>a.includes(e)?a.filter(a=>a!==e):[...a,e])},[]),N=i.useCallback(()=>{s(""),r([]),o([]),d({min:"",max:""}),h(""),g(""),f("")},[]),w=i.useMemo(()=>a||t.length>0||l.length>0||c.min||c.max||m||x||u,[a,t,l,c,m,x,u]);return{searchTerm:a,selectedInterests:t,selectedPlatforms:l,ageRange:c,selectedNationality:m,selectedLocation:x,selectedModality:u,setSearchTerm:s,setSelectedInterests:r,setSelectedPlatforms:o,setAgeRange:d,setSelectedNationality:h,setSelectedLocation:g,setSelectedModality:f,handleInterestToggle:j,handlePlatformToggle:y,clearFilters:N,filterOptions:v,filteredCreators:p,hasActiveFilters:w,totalCreators:e.length,filteredCount:p.length}})(a);return e.jsx("div",{className:"flex-1 bg-gray-50 overflow-auto",children:e.jsxs("div",{className:"p-8 max-w-7xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Creators"}),e.jsx("p",{className:"text-gray-600",children:"Gestiona y filtra tu base de creators registrados"})]}),e.jsx(c,{searchTerm:u.searchTerm,onSearchChange:u.setSearchTerm}),e.jsx(m,{filters:u}),0!==u.filteredCreators.length||t?e.jsx(g,{creators:u.filteredCreators,loading:t,loadingMore:r,error:l,hasMore:o,onRefresh:d,onLoadMore:h,onFavoriteChange:(e,a)=>{}}):e.jsx(x,{hasFilters:u.hasActiveFilters,onClearFilters:u.clearFilters})]})})},f={SearchBar:c,CreatorFilters:m,CreatorCard:h,EmptyState:x,CreatorsList:g,CreatorsPage:u};export{h as CreatorCard,m as CreatorFilters,g as CreatorsList,u as CreatorsPage,x as EmptyState,c as SearchBar,f as creatorsComponents,f as default};
