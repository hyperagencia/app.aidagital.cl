import{c as e,s as t,l as a,a as s}from"./index-CAD7YyIr.js";const r=new class{constructor(){this.baseURL=e.API_BASE,this.defaultHeaders={"Content-Type":"application/json"}}getHeaders(e={}){const a=t.get("authToken"),s={...this.defaultHeaders,...e};return a&&(s.Authorization=`Bearer ${a}`),s}async request(e,t={}){const a=`${this.baseURL}${e}`,s={headers:this.getHeaders(t.headers),...t};try{const e=await fetch(a,s);if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);return await e.json()}catch(r){throw r}}async get(e,t={}){const a=new URLSearchParams(t).toString(),s=a?`${e}?${a}`:e;return this.request(s,{method:"GET"})}async post(e,t={}){return this.request(e,{method:"POST",body:JSON.stringify(t)})}async put(e,t={}){return this.request(e,{method:"PUT",body:JSON.stringify(t)})}async delete(e){return this.request(e,{method:"DELETE"})}async upload(e,t){return this.request(e,{method:"POST",body:t,headers:{...this.getHeaders(),"Content-Type":void 0}})}setupAuthInterceptor(e){const a=this.request.bind(this);this.request=async(s,r={})=>{try{return await a(s,r)}catch(o){throw(o.message.includes("401")||o.message.includes("Unauthorized"))&&(t.remove("authToken"),e&&e()),o}}}},o={get:(e,t)=>r.get(e,t),post:(e,t)=>r.post(e,t),put:(e,t)=>r.put(e,t),delete:e=>r.delete(e),upload:(e,t)=>r.upload(e,t),setAuthInterceptor:e=>r.setupAuthInterceptor(e)},n=t=>!(!t||"string"!=typeof t)&&e.VALIDATION.EMAIL_REGEX.test(t.trim()),i=t=>!(!t||"string"!=typeof t)&&e.VALIDATION.PHONE_REGEX.test(t.trim()),l=t=>{const a=parseInt(t);return!isNaN(a)&&(a>=e.VALIDATION.MIN_AGE&&a<=e.VALIDATION.MAX_AGE)},c=e=>{if(!e||"string"!=typeof e)return!1;const t=e.trim();return t.length>=2&&t.length<=50},d=e=>null!=e&&("string"==typeof e?e.trim().length>0:!Array.isArray(e)||e.length>0),m={interests:e=>!!Array.isArray(e)&&(e.length>0&&e.length<=10),platforms:e=>{if(!Array.isArray(e))return!1;const t=["instagram","tiktok","youtube","otra"];return e.length>0&&e.every(e=>t.includes(e))},nationality:e=>{if(!e||"string"!=typeof e)return!1;return["chilena","extranjera"].includes(e.toLowerCase())},modality:e=>{if(!e||"string"!=typeof e)return!1;return["presencial","remoto","hibrido"].includes(e.toLowerCase())},location:e=>!(!e||"string"!=typeof e)&&e.trim().length>=3,username:e=>{if(!e||"string"!=typeof e)return!1;return/^[a-zA-Z0-9_]{3,20}$/.test(e)},postalCode:e=>{if(!e||"string"!=typeof e)return!1;return/^\d{7}$/.test(e)},rut:e=>{if(!e||"string"!=typeof e)return!1;const t=e.replace(/[^0-9kK]/g,"");if(t.length<8||t.length>9)return!1;const a=t.slice(0,-1),s=t.slice(-1).toUpperCase();let r=0,o=2;for(let i=a.length-1;i>=0;i--)r+=parseInt(a[i])*o,o=7===o?2:o+1;const n=r%11;return s===(0===n?"0":1===n?"K":(11-n).toString())}},u=(e,t)=>{const a={};return Object.entries(t).forEach(([t,s])=>{const r=e[t],o=[];s.forEach(e=>{if("function"==typeof e)e(r)||o.push("Campo inválido");else if("object"==typeof e){const{validator:t,message:a}=e;"function"!=typeof t||t(r)||o.push(a||"Campo inválido")}}),o.length>0&&(a[t]=o)}),{isValid:0===Object.keys(a).length,errors:a}},g={full_name:[{validator:d,message:"El nombre es requerido"},{validator:c,message:"El nombre debe tener entre 2 y 50 caracteres"}],email:[{validator:d,message:"El email es requerido"},{validator:n,message:"El email no es válido"}],phone:[{validator:d,message:"El teléfono es requerido"},{validator:i,message:"El teléfono no es válido"}],age:[{validator:d,message:"La edad es requerida"},{validator:l,message:`La edad debe estar entre ${e.VALIDATION.MIN_AGE} y ${e.VALIDATION.MAX_AGE} años`}],nationality:[{validator:d,message:"La nacionalidad es requerida"},{validator:m.nationality,message:"Selecciona una nacionalidad válida"}],location:[{validator:d,message:"La ubicación es requerida"},{validator:m.location,message:"La ubicación debe tener al menos 3 caracteres"}],modality:[{validator:d,message:"La modalidad es requerida"},{validator:m.modality,message:"Selecciona una modalidad válida"}],platforms:[{validator:d,message:"Debes seleccionar al menos una plataforma"},{validator:m.platforms,message:"Selecciona plataformas válidas"}],interests:[{validator:d,message:"Debes seleccionar al menos un interés"},{validator:m.interests,message:"Puedes seleccionar máximo 10 intereses"}]},h=e=>u(e,g);const p=new class{constructor(){this.baseEndpoint=e.ENDPOINTS.CREATORS.LIST,this.isDevelopment=e.DEBUG}async getCreators(t={}){try{a("Fetching creators with filters:",t);const s=this.buildQueryParams(t),r=await o.get(this.baseEndpoint,s);if(r.success)return a(`Fetched ${r.data.creators.length} creators`),{success:!0,creators:r.data.creators,total:r.data.total||r.data.creators.length,pagination:r.data.pagination||null};throw new Error(r.message||e.ERRORS.UNKNOWN)}catch(r){if(s(r,"Get creators"),!this.isDevelopment)return await this.getMockCreators(t);throw new Error(r.message||e.ERRORS.NETWORK)}}async getMockCreators(e={}){await new Promise(e=>setTimeout(e,800));const t=[{id:1,full_name:"María González",email:"maria.gonzalez@email.com",phone:"+56912345678",age:25,nationality:"chilena",location:"santiago",modality:"presencial",platforms:["instagram","tiktok"],interests:["moda","belleza","lifestyle"],followers_range:"10000-24999",created_at:new Date(Date.now()-432e6).toISOString(),status:"active",assigned_brand:null},{id:2,full_name:"Carlos Pérez",email:"carlos.perez@email.com",phone:"+56987654321",age:28,nationality:"chilena",location:"valparaiso",modality:"remoto",platforms:["youtube","instagram"],interests:["tecnologia","gaming","educacion"],followers_range:"25000-49999",created_at:new Date(Date.now()-2592e5).toISOString(),status:"active",assigned_brand:null},{id:3,full_name:"Ana Martín",email:"ana.martin@email.com",phone:"+56911111111",age:23,nationality:"extranjera",location:"concepcion",modality:"hibrido",platforms:["tiktok"],interests:["baile","musica","entretenimiento"],followers_range:"5000-9999",created_at:new Date(Date.now()-6048e5).toISOString(),status:"active",assigned_brand:null},{id:4,full_name:"Luis Rodríguez",email:"luis.rodriguez@email.com",phone:"+56922222222",age:30,nationality:"chilena",location:"santiago",modality:"presencial",platforms:["instagram","youtube"],interests:["deporte","fitness","nutricion"],followers_range:"mas-50000",created_at:new Date(Date.now()-1728e5).toISOString(),status:"active",assigned_brand:null},{id:5,full_name:"Sofía Morales",email:"sofia.morales@email.com",phone:"+56933333333",age:26,nationality:"chilena",location:"antofagasta",modality:"remoto",platforms:["instagram"],interests:["gastronomia","cocina","recetas"],followers_range:"1000-4999",created_at:new Date(Date.now()-864e5).toISOString(),status:"active",assigned_brand:null},{id:6,full_name:"Diego Silva",email:"diego.silva@email.com",phone:"+56944444444",age:24,nationality:"chilena",location:"valparaiso",modality:"presencial",platforms:["tiktok","youtube"],interests:["comedia","entretenimiento","viral"],followers_range:"10000-24999",created_at:new Date(Date.now()-864e6).toISOString(),status:"active",assigned_brand:null}],s=this.filterCreators(t,e);return a(`Mock creators loaded: ${s.length} of ${t.length}`),{success:!0,creators:s,total:s.length,pagination:null}}async getCreatorsStats(){try{if(a("Fetching creators statistics"),this.isDevelopment)return await this.getMockStats();const t=await o.get(e.ENDPOINTS.STATS.CREATORS);if(t.success)return a("Stats fetched successfully"),{success:!0,stats:t.data.stats};throw new Error(t.message||e.ERRORS.UNKNOWN)}catch(t){if(s(t,"Get creators stats"),!this.isDevelopment)return await this.getMockStats();throw new Error(t.message||e.ERRORS.NETWORK)}}async getMockStats(){await new Promise(e=>setTimeout(e,500));return{success:!0,stats:{overview:{total:6,thisMonth:4,today:1,monthlyGrowth:25.5},platforms:{instagram:4,tiktok:3,youtube:3},nationalities:{chilena:5,extranjera:1},locations:{santiago:2,valparaiso:2,concepcion:1,antofagasta:1},ageRanges:{"18-24":2,"25-34":4,"35-44":0,"45+":0},topInterests:{moda:1,belleza:1,tecnologia:1,deporte:1,gastronomia:1},lastUpdated:(new Date).toISOString()}}}async createCreator(e){if(this.isDevelopment){await new Promise(e=>setTimeout(e,1e3));return{success:!0,creator:{id:Date.now(),...e,created_at:(new Date).toISOString(),status:"active",assigned_brand:null},message:"Creator creado exitosamente (simulado)"}}throw new Error("Create creator not implemented in production mode")}buildQueryParams(e){const t={};return e.page&&(t.page=e.page),e.limit&&(t.limit=e.limit),e.sortBy&&(t.sortBy=e.sortBy),e.sortOrder&&(t.sortOrder=e.sortOrder),e.interests&&e.interests.length>0&&(t.interests=e.interests.join(",")),e.platforms&&e.platforms.length>0&&(t.platforms=e.platforms.join(",")),e.nationality&&(t.nationality=e.nationality),e.location&&(t.location=e.location),e.modality&&(t.modality=e.modality),e.ageMin&&(t.ageMin=e.ageMin),e.ageMax&&(t.ageMax=e.ageMax),t}filterCreators(e,t){return e.filter(e=>{var a,s;if(t.searchTerm){const r=t.searchTerm.toLowerCase(),o=null==(a=e.full_name)?void 0:a.toLowerCase().includes(r),n=null==(s=e.email)?void 0:s.toLowerCase().includes(r);if(!o&&!n)return!1}if(t.interests&&t.interests.length>0){if(!(e.interests&&t.interests.some(t=>e.interests.includes(t))))return!1}if(t.platforms&&t.platforms.length>0){if(!(e.platforms&&t.platforms.some(t=>e.platforms.includes(t))))return!1}if(t.ageMin||t.ageMax){const a=parseInt(e.age);if(isNaN(a))return!1;const s=t.ageMin?parseInt(t.ageMin):0,r=t.ageMax?parseInt(t.ageMax):200;if(a<s||a>r)return!1}return(!t.nationality||e.nationality===t.nationality)&&((!t.location||e.location===t.location)&&(!t.modality||e.modality===t.modality))})}validateCreatorData(e){return h(e)}};export{o as a,p as c};
